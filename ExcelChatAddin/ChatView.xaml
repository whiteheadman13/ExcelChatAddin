<UserControl x:Class="ExcelChatAddin.ChatView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             MinWidth="200"
             MinHeight="200">

    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="140"/>
            <RowDefinition Height="8"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- ============================= -->
        <!-- 操作ヘッダ（タイトル＋ボタン） -->
        <!-- ============================= -->
        <DockPanel Grid.Row="0" Margin="0,0,0,6">
            <TextBlock Text="指示（上：rangeプレビュー / 下：入力）"
                       FontWeight="Bold"
                       VerticalAlignment="Center"/>

            <StackPanel Orientation="Horizontal"
                        DockPanel.Dock="Right">
                <Button Content="マスキング確認"
                        Margin="8,0,0,0"
                        Padding="10,4"
                        Click="BtnMaskPreview_Click"/>
            </StackPanel>
        </DockPanel>

        <!-- ============================= -->
        <!-- range プレビュー（表示専用） -->
        <!-- ============================= -->
        <RichTextBox x:Name="PreviewBox"
                     Grid.Row="1"
                     IsReadOnly="True"
                     IsDocumentEnabled="True"
                     VerticalScrollBarVisibility="Auto"
                     BorderThickness="1"
                     Padding="4"
                     FontSize="16"/>

        <!-- ============================= -->
        <!-- スプリッター -->
        <!-- ============================= -->
        <GridSplitter Grid.Row="2"
                      Height="8"
                      HorizontalAlignment="Stretch"/>

        <!-- ============================= -->
        <!-- 入力欄（編集専用） -->
        <!-- ============================= -->
        <TextBox x:Name="InputBox"
                 Grid.Row="3"
                 AcceptsReturn="True"
                 TextWrapping="Wrap"
                 VerticalScrollBarVisibility="Auto"
                 BorderThickness="1"
                 Padding="8"
                 FontSize="16"
                 TextChanged="InputBox_TextChanged"/>
    </Grid>

</UserControl>
